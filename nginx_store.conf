## nginx snippet: rewrite /store/{slug} to /public/store.php?slug={slug}
## Include this inside your server block or place the file and include it from your nginx config.

# Serve pretty store URLs
location ~ ^/store/([^/]+)/? {
    rewrite ^/store/([^/]+)/?$ /public/store.php?slug=$1 last;
}

# Optional: redirect legacy query URL /public/store.php?slug=foo to pretty URL
location = /public/store.php {
    if ($arg_slug) {
        return 301 /store/$arg_slug;
    }
    # otherwise let PHP handle it
}

# If your PHP is served at /, ensure fastcgi params pass SCRIPT_FILENAME to /public/store.php
# Example server block snippet:
# server {
#   listen 80;
#   server_name example.com;
#   root /path/to/StockDirectaHT;
#   include /etc/nginx/mime.types;
#   include /etc/nginx/fastcgi_params;
#   location ~ ^/store/([^/]+)/? { rewrite ^/store/([^/]+)/?$ /public/store.php?slug=$1 last; }
#   location ~ \.php$ { fastcgi_pass unix:/run/php/php7.4-fpm.sock; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; include fastcgi_params; }
# }
